import{c as _}from"./index.B7y88wuR.js";const H=n=>{let s;const t=new Set,o=(i,S)=>{const h=typeof i=="function"?i(s):i;if(!Object.is(h,s)){const v=s;s=S??(typeof h!="object"||h===null)?h:Object.assign({},s,h),t.forEach(m=>m(s,v))}},a=()=>s,u={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(t.add(i),()=>t.delete(i))},d=s=n(o,a,u);return u},j=n=>n?H(n):H,N=n=>n;function w(n,s=N){const t=_.useSyncExternalStore(n.subscribe,()=>s(n.getState()),()=>s(n.getInitialState()));return _.useDebugValue(t),t}const E=n=>{const s=j(n),t=o=>w(s,o);return Object.assign(t,s),t},R=n=>E;function x(n,s){let t;try{t=n()}catch{return}return{getItem:a=>{var r;const f=d=>d===null?null:JSON.parse(d,void 0),u=(r=t.getItem(a))!=null?r:null;return u instanceof Promise?u.then(f):f(u)},setItem:(a,r)=>t.setItem(a,JSON.stringify(r,void 0)),removeItem:a=>t.removeItem(a)}}const b=n=>s=>{try{const t=n(s);return t instanceof Promise?t:{then(o){return b(o)(t)},catch(o){return this}}}catch(t){return{then(o){return this},catch(o){return b(o)(t)}}}},A=(n,s)=>(t,o,a)=>{let r={storage:x(()=>localStorage),partialize:e=>e,version:0,merge:(e,g)=>({...g,...e}),...s},f=!1;const u=new Set,d=new Set;let i=r.storage;if(!i)return n((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),t(...e)},o,a);const S=()=>{const e=r.partialize({...o()});return i.setItem(r.name,{state:e,version:r.version})},h=a.setState;a.setState=(e,g)=>{h(e,g),S()};const v=n((...e)=>{t(...e),S()},o,a);a.getInitialState=()=>v;let m;const I=()=>{var e,g;if(!i)return;f=!1,u.forEach(c=>{var l;return c((l=o())!=null?l:v)});const y=((g=r.onRehydrateStorage)==null?void 0:g.call(r,(e=o())!=null?e:v))||void 0;return b(i.getItem.bind(i))(r.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==r.version){if(r.migrate){const l=r.migrate(c.state,c.version);return l instanceof Promise?l.then(p=>[!0,p]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[p,O]=c;if(m=r.merge(O,(l=o())!=null?l:v),t(m,!0),p)return S()}).then(()=>{y?.(m,void 0),m=o(),f=!0,d.forEach(c=>c(m))}).catch(c=>{y?.(void 0,c)})};return a.persist={setOptions:e=>{r={...r,...e},e.storage&&(i=e.storage)},clearStorage:()=>{i?.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>I(),hasHydrated:()=>f,onHydrate:e=>(u.add(e),()=>{u.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},r.skipHydration||I(),m||v},F=A,P=R()(F(n=>({email:"",displayName:"",isAuthenticated:!1,setUser:(s,t,o)=>n({email:s,displayName:t,isAuthenticated:o}),resetUser:()=>n({email:"",displayName:"",isAuthenticated:!1})}),{name:"livre-auth-storage"}));export{P as u};
