import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.B7y88wuR.js";import{o as N,a as i,s as j,b as v,u as C}from"./firebase.Dme28GWg.js";import{u as S}from"./authStore.CYTjUqjB.js";import{L,y as u}from"./index.DXH7Qx-t.js";const F=()=>{const{setUser:o,isAuthenticated:p}=S(),[d,g]=n.useState(""),[l,h]=n.useState(""),[c,x]=n.useState(""),[r,f]=n.useState(!0),[w,b]=n.useState(!0);n.useEffect(()=>{const s=N(i,a=>{a?(o(a.email||"",a.displayName||"",!0),window.location.pathname==="/login"&&(window.location.href="/write")):o("","",!1),b(!1)});return()=>s()},[o]);const y=async s=>{if(s.preventDefault(),l.length<6){u.error("Password must be at least 6 characters.");return}try{if(r){const t=(await u.promise(j(i,d,l),{pending:"Logging in...",success:"Logged in successfully!",error:"Login failed. Check your credentials."})).user;await t.reload(),o(t.email||"",t.displayName||"",!0)}else{const a=await u.promise(v(i,d,l),{pending:"Creating account...",success:"Account created!",error:"Signup failed."}),t=i.currentUser;if(t&&c.trim()){await C(t,{displayName:c.trim()}),await t.reload();const m=i.currentUser;o(m?.email||"",m?.displayName||"",!0)}else o(t?.email||"",t?.displayName||"",!0)}setTimeout(()=>{window.location.href="/write"},1e3)}catch(a){const t=a?.message||"An error occurred";u.error(t.replace("Firebase: ","").replace("auth/","").replace(/\./g,""))}};return w?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-rosewood"})}):p?e.jsxs("div",{className:"text-center text-taupe p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-rosewood mx-auto mb-4"}),e.jsx("p",{className:"text-lg",children:"Redirecting..."})]}):e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg animate-fade-in max-w-md mx-auto",children:[e.jsx(L,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light",toastClassName:"!bg-blush !text-taupe",progressClassName:"!bg-gold"}),e.jsx("h2",{className:"text-3xl font-bold text-rosewood mb-8 text-center",children:r?"Welcome Back":"Create Account"}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[!r&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-taupe font-medium mb-2",children:"Name"}),e.jsx("input",{type:"text",id:"name",value:c,onChange:s=>x(s.target.value),className:"w-full px-4 py-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-rosewood transition-all",placeholder:"Enter your name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-taupe font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:d,onChange:s=>g(s.target.value),className:"w-full px-4 py-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-rosewood transition-all",placeholder:"Enter your email",required:!0,autoComplete:"username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-taupe font-medium mb-2",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:l,onChange:s=>h(s.target.value),className:"w-full px-4 py-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-rosewood transition-all",placeholder:"Enter your password",required:!0,autoComplete:r?"current-password":"new-password"})]}),e.jsx("button",{type:"submit",className:"w-full bg-rosewood text-white py-3 rounded-lg hover:bg-sienna transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:r?"Login":"Sign Up"})]}),e.jsxs("p",{className:"mt-6 text-center text-taupe",children:[r?"Don't have an account? ":"Already have an account? ",e.jsx("button",{type:"button",onClick:()=>f(!r),className:"text-rosewood hover:text-sienna transition-colors font-medium",children:r?"Sign Up":"Login"})]})]})};export{F as Auth};
