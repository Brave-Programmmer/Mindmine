import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.B7y88wuR.js";import{q as C,c as k,d as B,g as L}from"./firebase.Dme28GWg.js";const P=()=>{const[l,b]=a.useState([]),[y,v]=a.useState(!0),[u,j]=a.useState(""),[r,w]=a.useState([]),[i,N]=a.useState("title"),[o,n]=a.useState(1),x=20;a.useEffect(()=>{(async()=>{try{const s=C(k(B,"books")),S=(await L(s)).docs.map(f=>({id:f.id,...f.data()}));b(S)}catch(s){console.error("Error loading books:",s)}finally{v(!1)}})()},[]);const h=l.filter(e=>{const s=e.title.toLowerCase().includes(u.toLowerCase())||e.author.toLowerCase().includes(u.toLowerCase()),m=r.length===0||r.includes(e.genre);return s&&m}).sort((e,s)=>i==="title"?e.title.localeCompare(s.title):i==="totalChapters"?s.totalChapters-e.totalChapters:i==="views"?(s.views||0)-(e.views||0):0),c=Math.ceil(h.length/x),p=h.slice((o-1)*x,o*x),d=Array.from(new Set(l.map(e=>e.genre).filter(Boolean))).sort(),g=e=>{n(1),w(s=>s.includes(e)?s.filter(m=>m!==e):[...s,e])};return t.jsxs("div",{className:"p-6 max-w-screen-xl mx-auto font-inter",children:[" ",t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[t.jsx("input",{type:"text",placeholder:"Search by title or author...",value:u,onChange:e=>{n(1),j(e.target.value)},className:"w-full md:w-72 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-rose-500 transition","aria-label":"Search books by title or author"}),t.jsxs("select",{value:i,onChange:e=>N(e.target.value),className:"w-full md:w-48 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-rose-500 transition","aria-label":"Sort books",children:[t.jsx("option",{value:"title",children:"Sort by Title (A-Z)"}),t.jsx("option",{value:"totalChapters",children:"Sort by Chapters (desc)"}),t.jsx("option",{value:"views",children:"Sort by Views (desc)"})]})]}),t.jsxs("div",{className:"mb-6 flex flex-wrap gap-2 items-center",children:[d.length===0&&t.jsx("p",{className:"text-gray-500",children:"No genres available."}),d.slice(0,4).map(e=>t.jsxs("button",{onClick:()=>g(e),className:`px-3 py-1 rounded-full text-sm font-medium transition
              ${r.includes(e)?"bg-rose-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,"aria-pressed":r.includes(e),children:[e," (",l.filter(s=>s.genre===e).length,")"]},e)),d.length>4&&t.jsxs("div",{className:"relative group",children:[t.jsx("button",{className:"px-3 py-1 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 text-sm font-medium","aria-haspopup":"true","aria-expanded":"false",children:"More â–¾"}),t.jsx("div",{className:"absolute z-50 hidden group-hover:block bg-white border border-gray-300 rounded-md shadow-md p-2 max-h-52 overflow-y-auto w-40",children:d.slice(4).map(e=>t.jsxs("button",{onClick:()=>g(e),className:`block w-full text-left px-2 py-1 rounded-md text-sm transition
                    ${r.includes(e)?"bg-rose-600 text-white":"hover:bg-gray-100"}`,"aria-pressed":r.includes(e),children:[e," (",l.filter(s=>s.genre===e).length,")"]},e))})]})]}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:y?t.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Loading books..."}):p.length===0?t.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No books found."}):p.map(e=>t.jsx("div",{children:t.jsxs("a",{href:`/books/${e.id}`,className:`block relative w-full aspect-[2/3] rounded-lg overflow-hidden shadow-lg transform transition-all duration-300\r
                 hover:scale-[1.03] hover:shadow-2xl group cursor-pointer border border-gray-200 bg-white`,"aria-label":`View details of ${e.title} by ${e.author}`,children:[t.jsx("div",{className:`${e.coverImage} absolute inset-0 bg-cover bg-center transition-transform duration-300 group-hover:scale-105`}),t.jsxs("div",{className:`absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300\r
                  flex flex-col justify-end p-4 text-white text-center`,children:[t.jsx("h3",{className:"text-lg md:text-xl font-bold mb-1 leading-tight line-clamp-2",children:e.title}),t.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-200 mb-2 line-clamp-1",children:["By ",e.author]}),t.jsx("p",{className:"text-xs md:text-sm italic text-gray-300 line-clamp-3 mb-3",children:e.synopsis||"No synopsis available for this book."}),t.jsxs("div",{className:"flex justify-center gap-4 text-xs md:text-sm font-semibold mt-auto",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("i",{className:"fa-solid fa-book"})," ",e.totalChapters," ","chapters"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("i",{className:"fa-solid fa-eye"})," ",e.views||0," ","views"]})]})]}),t.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-3 text-white\r
                      transition-opacity duration-300 group-hover:opacity-0`,children:[t.jsx("p",{className:"text-sm font-bold truncate",children:e.title}),t.jsx("p",{className:"text-xs truncate text-gray-300",children:e.author})]})]})}))}),c>1&&t.jsxs("nav",{className:"mt-8 flex justify-center gap-3 select-none","aria-label":"Pagination",children:[t.jsx("button",{onClick:()=>n(e=>Math.max(1,e-1)),disabled:o===1,className:"px-3 py-1 rounded-md bg-gray-200 text-gray-600 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Previous"}),t.jsxs("span",{className:"px-3 py-1 rounded-md bg-rose-600 text-white font-semibold",children:[o," / ",c]}),t.jsx("button",{onClick:()=>n(e=>Math.min(c,e+1)),disabled:o===c,className:"px-3 py-1 rounded-md bg-gray-200 text-gray-600 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Next"})]})]})};export{P as default};
